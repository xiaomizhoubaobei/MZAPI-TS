name: æ¬¢è¿Žé—®å€™

on: [pull_request_target, issues]

permissions:
 contents: read

jobs:
 greeting:
  runs-on: ubuntu-latest
  permissions:
   issues: write
   pull-requests: write
  steps:
   - name: Harden the runner (Audit all outbound calls)
     uses: step-security/harden-runner@f4a75cfd619ee5ce8d5b864b0d183aff3c69b55a # v2.13.1
     with:
      egress-policy: audit

   - name: Audit - Workflow started
     run: |
       echo "Greetings workflow started" >> audit.log
       echo "Event type: ${{ github.event_name }}" >> audit.log
       if [ "${{ github.event_name }}" = "issues" ]; then
         echo "Issue number: ${{ github.event.issue.number }}" >> audit.log
         echo "Issue author: ${{ github.event.issue.user.login }}" >> audit.log
       elif [ "${{ github.event_name }}" = "pull_request_target" ]; then
         echo "PR number: ${{ github.event.pull_request.number }}" >> audit.log
         echo "PR author: ${{ github.event.pull_request.user.login }}" >> audit.log
       fi
       echo "Timestamp: $(date -u)" >> audit.log

   - uses: actions/first-interaction@1c4688942c71f71d4f5502a26ea67c331730fa4d # v3.1.0
     with:
       repo_token: ${{ secrets.GITHUB_TOKEN }}
       issue_message: |
         ðŸ‘‹ æ„Ÿè°¢æ‚¨æäº¤é¦–ä¸ª Issueï¼
         æˆ‘ä»¬éžå¸¸é‡è§†æ‚¨çš„åé¦ˆï¼Œå›¢é˜Ÿå°†å°½å¿«å®¡æ ¸å¹¶å›žå¤ã€‚
       pr_message: |
         ðŸŽ‰ æ„Ÿè°¢æ‚¨æäº¤é¦–ä¸ª Pull Requestï¼
         æˆ‘ä»¬æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼Œå›¢é˜Ÿå°†å°½å¿«å®¡æ ¸æ‚¨çš„ä»£ç ã€‚
   - name: Audit - First interaction completed
     run: |
       echo "First interaction completed" >> audit.log
       echo "Event type: ${{ github.event_name }}" >> audit.log
       echo "Timestamp: $(date -u)" >> audit.log

   - name: Upload audit log
     uses: actions/upload-artifact@v5
     with:
       name: greetings-audit-log
       path: audit.log
       retention-days: 30